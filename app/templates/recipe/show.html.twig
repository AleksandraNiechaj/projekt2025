{% extends 'base.html.twig' %}

{% block title %}{{ recipe.title }}{% endblock %}

{% block body %}
    <h1>{{ recipe.title }}</h1>
    <p class="text-muted">{{ recipe.createdAt|date('Y-m-d H:i') }}</p>
    <div class="mb-4">{{ recipe.content|nl2br }}</div>

    {# …inne informacje o przepisie… #}

    <hr>

    <h2>Komentarze</h2>

    <ul class="list-unstyled">
        {% for c in recipe.comments %}
            <li class="mb-3 border-bottom pb-2">
                <strong>{{ c.nick }}</strong>
                <small class="text-muted">{{ c.createdAt|date('Y-m-d H:i') }}</small>
                <p>{{ c.content|nl2br }}</p>

                {% if is_granted('ROLE_ADMIN') %}
                    <form method="post" action="{{ path('comment_delete', {id: c.id}) }}"
                          onsubmit="return confirm('Usunąć komentarz?');">
                        <input type="hidden" name="_token"
                               value="{{ csrf_token('delete-comment' ~ c.id) }}">
                        <button class="btn btn-sm btn-danger">Usuń</button>
                    </form>
                {% endif %}
            </li>
        {% else %}
            <li>Brak komentarzy.</li>
        {% endfor %}
    </ul>

    <h3>Dodaj komentarz</h3>
    {{ form_start(commentForm) }}
    {{ form_row(commentForm.nick) }}
    {{ form_row(commentForm.email) }}
    {{ form_row(commentForm.content) }}
    {{ form_row(commentForm.save) }}
    {{ form_end(commentForm) }}

{% endblock %}
